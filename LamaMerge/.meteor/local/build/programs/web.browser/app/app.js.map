{"version":3,"sources":["meteor://üíªapp/client/main.js"],"names":[],"mappings":";;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEA,cAAc,IAAI,aAAM,UAAN,CAAiB,SAArB,CAAd;;AAEA,YAAY,YAAZ,CAAyB,IAAI,YAAJ,CAAiB;AACxC,SAAO;AACL,UAAM,MAAN;AACA,WAAO,OAAP;GAFF;AAIA,UAAQ;AACN,UAAM,MAAN;AACA,WAAO,QAAP;GAFF;AAIA,QAAM;AACJ,UAAM,MAAN;AACA,WAAO,MAAP;AACA,SAAK,EAAL;AACA,SAAK,EAAL;AACA,cAAU,IAAV;GALF;AAOA,QAAM;AACJ,UAAM,MAAN;AACA,WAAO,MAAP;GAFF;AAIA,WAAS;AACP,UAAM,MAAN;AACA,WAAO,qDAAP;GAFF;AAIA,YAAU;AACR,UAAM,MAAN;AACA,WAAO,UAAP;AACA,cAAU,IAAV;AACA,SAAK,IAAL;GAJF;CAxBuB,CAAzB;;;;AAmCA,qBAAS,MAAT,CAAgB,MAAhB,CAAuB;AACrB;wBAAgB,OAAO,UAAW;AAChC,YAAM,cAAN;;AADgC,UAG5B,OAAO;AACT,eAAO,SAAS,IAAT,CAAe,uBAAf,EAAyC,KAAzC;AACP,kBAAU,SAAS,IAAT,CAAe,mBAAf,EAAqC,KAArC;OAFR;;AAH4B,cAQhC,CAAS,UAAT,CAAqB,IAArB,EAA2B,UAAE,KAAF,EAAa;AACtC,YAAK,KAAL,EAAa;AACX,eAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;SAAb,MAEO;AACL,iBAAO,IAAP,CAAa,sBAAb,EAAqC,UAAE,KAAF,EAAS,QAAT,EAAuB;AAC1D,gBAAK,KAAL,EAAa;AACX,mBAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;aAAb,MAEO;AACL,mBAAK,KAAL,CAAY,YAAZ,EAA0B,SAA1B,EADK;aAFP;WADmC,CAArC,CADK;SAFP;OADyB,CAA3B,CARgC;;;;KADb;CAAvB;;;AA2BA,qBAAS,KAAT,CAAe,MAAf,CAAsB;AACpB;yCAAoC,OAAO,UAAW;AACpD,aAAO,IAAP,CAAa,sBAAb,EAAqC,UAAE,KAAF,EAAS,QAAT,EAAuB;AAC1D,YAAK,KAAL,EAAa;AACX,eAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;SAAb,MAEO;AACL,cAAI,QAAQ,OAAO,IAAP,GAAc,MAAd,CAAsB,CAAtB,EAA0B,OAA1B,CADP;AAEL,eAAK,KAAL,6BAAuC,WAAvC,EAAkD,SAAlD,EAFK;SAFP;OADmC,CAArC,CADoD;;;;KADlC;CAAtB;;AAaA,WAAW,KAAX,CAAkB,sBAAlB,EAA0C;AACxC,QAAM,cAAN;AACA;oBAAQ,QAAS;AACf,eAAS,WAAT,CAAsB,OAAO,KAAP,EAAc,UAAE,KAAF,EAAY;AAC9C,YAAK,KAAL,EAAa;AACX,eAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;SAAb,MAEO;AACL,qBAAW,EAAX,CAAe,GAAf,EADK;AAEL,eAAK,KAAL,CAAY,8CAAZ,EAA4D,SAA5D,EAFK;SAFP;OADkC,CAApC,CADe;;;;KAFuB;CAA1C;;;;AAgBA,qBAAS,IAAT,CAAc,OAAd,CAAsB;;AAEpB;AAAW,sBAAU;AACnB,UAAI,UAAU,QAAQ,GAAR,CAAY,cAAZ,CAAV,CADe;AAEnB,cAAQ,GAAR,CAAY,OAAZ,EAFmB;AAGnB,cAAQ,GAAR,CAAY,YAAZ,EAA0B,OAA1B,EAHmB;AAInB,aAAO,OAAP,CAJmB;KAAV;;;KAAX;CAFF;;AAUA,qBAAS,QAAT,CAAkB,OAAlB,CAA0B;AACxB;AAAkB,6BAAU;AAC1B,UAAI,aAAa,KAAK,EAAL,CADS;AAE1B,UAAI,eAAe,QAAQ,GAAR,CAAY,cAAZ,EAA4B,UAA5B,CAAf,CAFsB;AAG1B,UAAG,cAAc,YAAd,EAA2B;AAC5B,eAAO,UAAP,CAD4B;OAA9B;KAHgB;;;KAAlB;CADF;;AAWA,qBAAS,KAAT,CAAe,MAAf,CAAsB;AACpB;AAAoB,8BAAU;AAC1B,UAAI,YAAa,SAAS,KAAT,CAAe,YAAf,EAA6B,SAA7B,CAAuC,KAAvC,CADS;AAE1B,UAAI,eAAa,0DAAwD,SAAxD;;AAFS,UAItB,IAAJ,CAJ0B;AAK1B,QAAE,GAAF,CAAM,YAAN,EAAoB,UAAS,IAAT,EAAc;;AAEhC,gBAAQ,GAAR,CAAY,cAAZ,EAA4B,KAAK,KAAL,CAA5B,CAFgC;OAAd,CAApB,CAL0B;KAAV;;;KAApB;CADF;;AAaA,qBAAS,QAAT,CAAkB,MAAlB,CAAyB;AACtB;AAAe,yBAAU;AACxB,UAAI,aAAa,KAAK,EAAL,CADO;AAExB,cAAQ,GAAR,CAAY,UAAZ,EAFwB;AAGxB,cAAQ,GAAR,CAAY,cAAZ,EAA4B,UAA5B,EAHwB;KAAV;;;KAAf;CADH;;AAQA,qBAAS,IAAT,CAAc,MAAd,CAAqB;AACnB;AAAsB,+BAAU;AAC5B,UAAI,QAAQ,EAAE,QAAF,EAAY,IAAZ,EAAR,CADwB;AAE5B,cAAQ,GAAR,CAAY,KAAZ,EAF4B;AAG5B,cAAQ,MAAM,KAAN,CAAY,MAAZ,CAAR,CAH4B;AAI5B,cAAQ,GAAR,CAAY,KAAZ,EAJ4B;AAK5B,UAAI,MAAM,MAAM,CAAN,CAAN,CALwB;AAM5B,UAAI,MAAM,MAAM,CAAN,CAAN,CANwB;AAO5B,UAAI,MAAM,MAAM,CAAN,CAAN,CAPwB;AAQ5B,UAAI,MAAM,SAAS,KAAT,CAAe,IAAf,EAAqB,GAArB,CAAyB,KAAzB,CARkB;AAS5B,UAAI,QAAQ,SAAS,KAAT,CAAe,IAAf,EAAqB,KAArB,CAA2B,KAA3B,CATgB;AAU5B,UAAI,OAAO,SAAS,KAAT,CAAe,IAAf,EAAqB,IAArB,CAA0B,KAA1B,CAViB;AAW5B,kBAAY,MAAZ,CACE;AACE,eAAO,MAAM,CAAN,CAAP;AACA,gBAAQ,MAAM,CAAN,CAAR;AACA,cAAM,KAAN;AACA,iBAAS,IAAT;AACA,kBAAU,GAAV;;OANJ,EAX4B;KAAV;;;KAAtB;CADF;;AAyBA,qBAAS,MAAT,CAAgB,SAAhB,CAA2B,YAAM;AAC/B,MAAI,WAAW,qBAAS,QAAT,EAAX,CAD2B;;AAG/B,WAAS,WAAT,GAAuB,8BAAvB;AAH+B,UAI/B,CAAS,SAAT,GAAuB,6BAAiB,KAAjB,CAAvB,CAJ+B;;AAM/B,WAAS,OAAT,CAAkB,YAAM;AACtB,aAAS,SAAT,CAAoB,SAApB,EAA+B,SAAS,WAAT,CAAqB,GAArB,EAA/B,EAA2D,YAAM;;AAC/D,iBAAY,YAAM;AAChB,iBAAS,SAAT,CAAmB,GAAnB,CAAwB,KAAxB,EADgB;OAAN,EAET,GAFH,EAD+D;KAAN,CAA3D,CADsB;GAAN,CAAlB,CAN+B;CAAN,CAA3B;;AAeA,qBAAS,MAAT,CAAgB,OAAhB,CAAwB;AACtB;yBAAY;AACV,aAAO,qBAAS,QAAT,GAAoB,SAApB,CAA8B,GAA9B,EAAP,CADU;;;;KADU;AAItB;qBAAQ;AACN,aAAO,qBAAS,QAAT,GAAoB,WAApB,CAAgC,GAAhC,EAAP,CADM;;;;KAJc;AAOtB;oBAAO;AACL,UAAI,UAAU,YAAY,IAAZ,EAAV,CADC;AAEL,UAAK,OAAL,EAAe;AACb,eAAO,OAAP,CADa;OAAf;;;;KAToB;CAAxB;;AAeA,qBAAS,MAAT,CAAgB,MAAhB,CAAuB;AACrB;6BAA0B,OAAO,UAAW;AAC1C,UAAI,QAAQ,MAAM,MAAN,CAAa,KAAb,CAAmB,IAAnB,EAAR,CADsC;;AAG1C,UAAK,UAAU,EAAV,IAAgB,MAAM,OAAN,KAAkB,EAAlB,EAAuB;AAC1C,iBAAS,WAAT,CAAqB,GAArB,CAA0B,KAA1B,EAD0C;AAE1C,iBAAS,SAAT,CAAmB,GAAnB,CAAwB,IAAxB,EAF0C;OAA5C;;AAKA,UAAK,UAAU,EAAV,EAAe;AAClB,iBAAS,WAAT,CAAqB,GAArB,CAA0B,KAA1B,EADkB;OAApB;;;;KATmB;CAAvB,qH","file":"/app.js","sourcesContent":["import { Template } from 'meteor/templating';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { Mongo } from 'meteor/mongo';\nimport './main.html';\n\nAnnonceList = new Mongo.Collection('annonce');\n\nAnnonceList.attachSchema(new SimpleSchema({\n  title: {\n    type: String,\n    label: \"Titre\",\n  },\n  author: {\n    type: String,\n    label: \"Auteur\",\n  },\n  isbn: {\n    type: String,\n    label: \"ISBN\",\n    max: 17,\n    min: 17,\n    optional: true\n  },\n  prix: {\n    type: Number,\n    label: \"Prix\",\n  },\n  contact: {\n    type: String,\n    label: \"L'adresse mail √† laquelle vous voulez √™tre contact√©\"\n  },\n  remarque: {\n    type: String,\n    label: \"Remarque\",\n    optional: true,\n    max: 1000\n  }\n}));\n\t\n\n// Toute cette partie contient du code li√© au LOGIN \n  \nTemplate.signup.events({\n  'submit form' ( event, template ) {\n    event.preventDefault(); // cr√©ation d'un event lorsque l'utilisateur soumet sa demande de cr√©ation de compte\n    \n    let user = {\n      email: template.find( '[name=\"emailAddress\"]' ).value,\n      password: template.find( '[name=\"password\"]' ).value\n    }; // r√©cup√©ration de l'email de l'utilisateur demandant la cr√©ation de compte\n\n    Accounts.createUser( user, ( error ) => {\n      if ( error ) {\n        Bert.alert( error.reason, 'danger' );\n      } else {\n        Meteor.call( 'sendVerificationLink', ( error, response ) => {\n          if ( error ) {\n            Bert.alert( error.reason, 'danger' );\n          } else {\n            Bert.alert( 'Bienvenue!', 'success' );\n          }\n        });\n      }\n    });\n  }\n}); // G√©n√®re des alertes gr√¢ce √† Bert en fonction des donn√©es entr√©es par l'utilisateur (mauvais mdp, email. etc.)\n\n\n// Rechercher une annonce\nTemplate.index.events({\n  'click .resend-verification-link' ( event, template ) {\n    Meteor.call( 'sendVerificationLink', ( error, response ) => {\n      if ( error ) {\n        Bert.alert( error.reason, 'danger' );\n      } else {\n        let email = Meteor.user().emails[ 0 ].address;\n        Bert.alert( `V√©rification envoy√©e √† ${ email }!`, 'success' );\n      }\n    });\n  }\n}); // lien pour renvoy√© un mail de v√©rification au format alerte Bert\n\nFlowRouter.route( '/verify-email/:token', {\n  name: 'verify-email',\n  action( params ) {\n    Accounts.verifyEmail( params.token, ( error ) =>{\n      if ( error ) {\n        Bert.alert( error.reason, 'danger' );\n      } else {\n        FlowRouter.go( '/' );\n        Bert.alert( 'V√©rification r√©ussie! Merci et bonne visite!', 'success' );\n      }\n    });\n  }\n}); // Cr√©ation du routing de v√©rification gr√¢ce √† Flowrouter. \n\n// Fin de la partie LOGIN \n\nTemplate.body.helpers({\n    // d√©finit le contexte de r√©sultats\n  'result' : function(){\n    var listRes = Session.get('selectedbook');\n    console.log(listRes);\n    Session.set('listResult', listRes);\n    return listRes;\n  }\n});\n\nTemplate.resultat.helpers({\n  'selectedClass' : function(){\n    var bookChoisi = this.id;\n    var livreclicked = Session.get('livreclicked', bookChoisi);\n    if(bookChoisi == livreclicked){\n      return \"selected\";\n    }\n\n  }\n})\n\nTemplate.ajout.events({\n  'click .SearchIPA': function(){\n      var infolivre = (document.forms['searchitem'].champinfo.value);\n      var stringsearch=\"https://www.googleapis.com/books/v1/volumes?q=search+\"+infolivre;\n   //   alert(\"requ√™te envoy√©e: \"+stringsearch);\n      var data;\n      $.get(stringsearch, function(data){\n       // alert(\"Donn√©es re√ßues: \"+data);\n        Session.set('selectedbook', data.items);\n      });           \n  }\n})\n\nTemplate.resultat.events({\n   'click .book': function(){\n    var bookChoisi = this.id;\n    console.log(bookChoisi);\n    Session.set('livreclicked', bookChoisi);\n  }\n})\n\nTemplate.body.events({\n  'click .AddAnnonce' : function(){   \n      var chain = $(\"#koala\").html();\n      console.log(chain);\n      chain = chain.split(/<br>/);\n      console.log(chain);\n      var tit = chain[0];\n      var aut = chain[1];\n      var img = chain[2];\n      var rem = document.forms['ad'].com.value;\n      var price = document.forms['ad'].price.value;\n      var cont = document.forms['ad'].cont.value;\n      AnnonceList.insert(\n        {\n          title: chain[0],\n          author: chain[1],\n          prix: price,\n          contact: cont,\n          remarque: rem\n\n        }\n      ); \n  }\n})\n// code nous permettant de stocker n'importe quoi sur ce template\nTemplate.search.onCreated( () => {\n  let template = Template.instance();\n\n  template.searchQuery = new ReactiveVar(); //permet d'afficher la valeur la plus r√©cente\n  template.searching   = new ReactiveVar( false );\n\n  template.autorun( () => {\n    template.subscribe( 'annonce', template.searchQuery.get(), () => { //searchQuery nous permet de retenir la valeur qui a √©t√© plac√©e dans la barre de recherche\n      setTimeout( () => {\n        template.searching.set( false );\n      }, 300 ); \n    });\n  });\n});\n\nTemplate.search.helpers({\n  searching() {\n    return Template.instance().searching.get();\n  },\n  query() {\n    return Template.instance().searchQuery.get();\n  },\n  book() {\n    let annonce = AnnonceList.find();\n    if ( annonce ) {\n      return annonce;\n    }\n  }\n});\n\nTemplate.search.events({\n  'keyup [name=\"search\"]' ( event, template ) {\n    let value = event.target.value.trim();\n\n    if ( value !== '' && event.keyCode === 13 ) {\n      template.searchQuery.set( value );\n      template.searching.set( true );\n    }\n\n    if ( value === '' ) {\n      template.searchQuery.set( value );\n    }\n  }\n});\n"]}