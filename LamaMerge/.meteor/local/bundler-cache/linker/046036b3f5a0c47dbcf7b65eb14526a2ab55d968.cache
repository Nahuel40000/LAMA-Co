[{"type":"js","data":"/* Imports for global scope */\n\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\n$ = Package.jquery.$;\njQuery = Package.jquery.jQuery;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nAutoForm = Package['aldeed:autoform'].AutoForm;\nBert = Package['themeteorchef:bert'].Bert;\nFlowRouter = Package['kadira:flow-router'].FlowRouter;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\n_ = Package.underscore._;\nDDP = Package['ddp-client'].DDP;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nBlaze = Package.ui.Blaze;\nUI = Package.ui.UI;\nHandlebars = Package.ui.Handlebars;\nSpacebars = Package.spacebars.Spacebars;\nTemplate = Package.templating.Template;\nmeteorInstall = Package.modules.meteorInstall;\nBuffer = Package.modules.Buffer;\nprocess = Package.modules.process;\nSymbol = Package['ecmascript-runtime'].Symbol;\nMap = Package['ecmascript-runtime'].Map;\nSet = Package['ecmascript-runtime'].Set;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nSimpleSchema = Package['aldeed:simple-schema'].SimpleSchema;\nMongoObject = Package['aldeed:simple-schema'].MongoObject;\nAccounts = Package['accounts-base'].Accounts;\nAutoupdate = Package.autoupdate.Autoupdate;\nReload = Package.reload.Reload;\nHTML = Package.htmljs.HTML;\n\n","servePath":"/packages/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"client\":{\"main.html\":[\"./template.main.js\",function(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// client/main.html                                                                                                 //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nmodule.exports = require(\"./template.main.js\");                                                                     // 1\n                                                                                                                    // 2\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"template.main.js\":function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// client/template.main.js                                                                                          //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\n                                                                                                                    // 1\nTemplate.body.addContent((function() {                                                                              // 2\n  var view = this;                                                                                                  // 3\n  return [ Spacebars.include(view.lookupTemplate(\"accueil\")), HTML.Raw(\"\\n  <p>----------------------------------</p>\\n  \"), Blaze.View(\"lookup:signup\", function() {\n    return Spacebars.mustache(view.lookup(\"signup\"));                                                               // 5\n  }), \" \\n  \\n  \", Blaze.If(function() {                                                                            // 6\n    return Spacebars.call(view.lookup(\"currentUser\"));                                                              // 7\n  }, function() {                                                                                                   // 8\n    return [ \" \\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"recherche\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"affichage_annonce\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", HTML.H2(\"Insert:\"), \"\\n  \", HTML.Comment(\"{{> creer_annonce}}\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"insertAnnonceForm\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", HTML.H2(\"Update:\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"updateAnnonceForm\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"grouper_annonce\")), \"\\n\\n\" ];\n  }, function() {                                                                                                   // 10\n    return [ \"\\n    \", HTML.P(\"You must be logged-in to see this content.\"), \"\\n\\n  \" ];                            // 11\n  }) ];                                                                                                             // 12\n}));                                                                                                                // 13\nMeteor.startup(Template.body.renderToDocument);                                                                     // 14\n                                                                                                                    // 15\nTemplate.__checkName(\"accueil\");                                                                                    // 16\nTemplate[\"accueil\"] = new Template(\"Template.accueil\", (function() {                                                // 17\n  var view = this;                                                                                                  // 18\n  return HTML.Raw(\"<h1>Bienvenue sur l'app LAMA</h1>\");                                                             // 19\n}));                                                                                                                // 20\n                                                                                                                    // 21\nTemplate.__checkName(\"register\");                                                                                   // 22\nTemplate[\"register\"] = new Template(\"Template.register\", (function() {                                              // 23\n  var view = this;                                                                                                  // 24\n  return HTML.Raw('<h2>Register</h2>\\n    <form class=\"register\">\\n        <p>Email: <input type=\"email\" name=\"email\"></p>\\n        <p>Password: <input type=\"password\" name=\"password\"></p>\\n        <p><input type=\"submit\" value=\"Register\"></p>\\n    </form>');\n}));                                                                                                                // 26\n                                                                                                                    // 27\nTemplate.__checkName(\"recherche\");                                                                                  // 28\nTemplate[\"recherche\"] = new Template(\"Template.recherche\", (function() {                                            // 29\n  var view = this;                                                                                                  // 30\n  return HTML.Raw('<p>Rechercher un livre:</p>\\n  <form>\\n    Entrer l\\'ISBN, le titre du livre ou l\\'auteur: <input type=\"text\">\\n    <input type=\"button\" value=\"Rechercher\">\\n  </form>');\n}));                                                                                                                // 32\n                                                                                                                    // 33\nTemplate.__checkName(\"affichage_annonce\");                                                                          // 34\nTemplate[\"affichage_annonce\"] = new Template(\"Template.affichage_annonce\", (function() {                            // 35\n  var view = this;                                                                                                  // 36\n  return HTML.Raw(\"<p>Annonces disponibles:</p>\\n  <ul>\\n    <li>\\n      Annonce 1\\n      <div>Prix</div> <br>\\n    </li>\\n    <li>\\n      Annonce 2\\n      <div>Prix</div> <br>\\n    </li>\\n    <li>\\n      Annonce 3\\n      <div>Prix</div> <br>\\n    </li>\\n  </ul>\");\n}));                                                                                                                // 38\n                                                                                                                    // 39\nTemplate.__checkName(\"insertAnnonceForm\");                                                                          // 40\nTemplate[\"insertAnnonceForm\"] = new Template(\"Template.insertAnnonceForm\", (function() {                            // 41\n  var view = this;                                                                                                  // 42\n  return Blaze._TemplateWith(function() {                                                                           // 43\n    return {                                                                                                        // 44\n      collection: Spacebars.call(\"AnnonceList\"),                                                                    // 45\n      id: Spacebars.call(\"insertAnnonceForm\"),                                                                      // 46\n      type: Spacebars.call(\"insert\")                                                                                // 47\n    };                                                                                                              // 48\n  }, function() {                                                                                                   // 49\n    return Spacebars.include(view.lookupTemplate(\"quickForm\"));                                                     // 50\n  });                                                                                                               // 51\n}));                                                                                                                // 52\n                                                                                                                    // 53\nTemplate.__checkName(\"updateAnnonceForm\");                                                                          // 54\nTemplate[\"updateAnnonceForm\"] = new Template(\"Template.updateAnnonceForm\", (function() {                            // 55\n  var view = this;                                                                                                  // 56\n  return Blaze._TemplateWith(function() {                                                                           // 57\n    return {                                                                                                        // 58\n      collection: Spacebars.call(\"AnnonceList\"),                                                                    // 59\n      id: Spacebars.call(\"updateAnnonceForm\"),                                                                      // 60\n      type: Spacebars.call(\"update\")                                                                                // 61\n    };                                                                                                              // 62\n  }, function() {                                                                                                   // 63\n    return Spacebars.include(view.lookupTemplate(\"quickForm\"));                                                     // 64\n  });                                                                                                               // 65\n}));                                                                                                                // 66\n                                                                                                                    // 67\nTemplate.__checkName(\"grouper_annonce\");                                                                            // 68\nTemplate[\"grouper_annonce\"] = new Template(\"Template.grouper_annonce\", (function() {                                // 69\n  var view = this;                                                                                                  // 70\n  return HTML.Raw('Grouper mes annonces: <br>\\n  <ul>\\n    <li>\\n      Annonce 1\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 2\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 3\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 4\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 5\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n  </ul>\\n  <form>\\n    <input type=\"text\" placeholder=\"prix de groupe\">\\n    <input type=\"button\" value=\"Grouper\">\\n  </form>');\n}));                                                                                                                // 72\n                                                                                                                    // 73\nTemplate.__checkName(\"signup\");                                                                                     // 74\nTemplate[\"signup\"] = new Template(\"Template.signup\", (function() {                                                  // 75\n  var view = this;                                                                                                  // 76\n  return HTML.Raw('<div class=\"row\">\\n    <div class=\"col-xs-12 col-sm-6 col-md-4\">\\n      <h4 class=\"page-header\">Sign Up</h4>\\n      <form id=\"signup\" class=\"signup\">\\n        <div class=\"form-group\">\\n          <label for=\"emailAddress\">Email Address</label>\\n          <input type=\"email\" name=\"emailAddress\" class=\"form-control\" placeholder=\"Email Address\">\\n        </div>\\n        <div class=\"form-group\">\\n          <label for=\"password\">Password</label>\\n          <input type=\"password\" name=\"password\" class=\"form-control\" placeholder=\"Password\">\\n        </div>\\n        <div class=\"form-group\">\\n          <input type=\"submit\" class=\"btn btn-success\" value=\"Sign Up\">\\n        </div>\\n      </form>\\n    </div>\\n  </div>');\n}));                                                                                                                // 78\n                                                                                                                    // 79\nTemplate.__checkName(\"index\");                                                                                      // 80\nTemplate[\"index\"] = new Template(\"Template.index\", (function() {                                                    // 81\n  var view = this;                                                                                                  // 82\n  return Blaze.Unless(function() {                                                                                  // 83\n    return Spacebars.call(Spacebars.dot(view.lookup(\"currentUser\"), \"emails\", \"0\", \"verified\"));                    // 84\n  }, function() {                                                                                                   // 85\n    return [ \"\\n    \", HTML.P({                                                                                     // 86\n      \"class\": \"alert alert-warning\"                                                                                // 87\n    }, \"You need to verify your email address before using Unibooks. \", HTML.A({                                    // 88\n      href: \"#\",                                                                                                    // 89\n      \"class\": \"resend-verification-link\"                                                                           // 90\n    }, \"Resend verification link\"), \".\"), \"\\n  \" ];                                                                 // 91\n  }, function() {                                                                                                   // 92\n    return [ \"\\n    \", HTML.H3(\"From all the way Downtown!\"), \"\\n    \", HTML.IMG({                                  // 93\n      src: \"https://media.giphy.com/media/dpu95OTQ9rDPi/giphy.gif\"                                                  // 94\n    }), \"\\n  \" ];                                                                                                   // 95\n  });                                                                                                               // 96\n}));                                                                                                                // 97\n                                                                                                                    // 98\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"main.js\":[\"meteor/templating\",\"meteor/reactive-var\",\"meteor/mongo\",\"./main.html\",function(require){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// client/main.js                                                                                                   //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nvar _templating = require('meteor/templating');                                                                     // 1\n                                                                                                                    //\nvar _reactiveVar = require('meteor/reactive-var');                                                                  // 2\n                                                                                                                    //\nvar _mongo = require('meteor/mongo');                                                                               // 3\n                                                                                                                    //\nrequire('./main.html');                                                                                             // 4\n                                                                                                                    //\nAnnonceList = new _mongo.Mongo.Collection('annonce');                                                               // 6\n                                                                                                                    //\nAnnonceList.attachSchema(new SimpleSchema({                                                                         // 8\n  title: {                                                                                                          // 9\n    type: String,                                                                                                   // 10\n    label: \"Title\",                                                                                                 // 11\n    max: 200                                                                                                        // 12\n  },                                                                                                                //\n  author: {                                                                                                         // 14\n    type: String,                                                                                                   // 15\n    label: \"Author\"                                                                                                 // 16\n  },                                                                                                                //\n  copies: {                                                                                                         // 18\n    type: Number,                                                                                                   // 19\n    label: \"Number of copies\",                                                                                      // 20\n    min: 0                                                                                                          // 21\n  },                                                                                                                //\n  etat: {                                                                                                           // 23\n    type: String,                                                                                                   // 24\n    label: \"Etat du livre\"                                                                                          // 25\n  },                                                                                                                //\n  remarque: {                                                                                                       // 27\n    type: String,                                                                                                   // 28\n    label: \"Remarque\",                                                                                              // 29\n    optional: true,                                                                                                 // 30\n    max: 1000                                                                                                       // 31\n  }                                                                                                                 //\n}));                                                                                                                //\n                                                                                                                    //\n//Le code qui correspond au if(meteorisclient) de l'ancien fichier 1.2                                              //\n                                                                                                                    //\n_templating.Template.signup.events({                                                                                // 39\n  'submit form': function () {                                                                                      // 40\n    function submitForm(event, template) {                                                                          //\n      event.preventDefault(); // création d'une event lorsque l'utilisateur soumet sa demande de création de compte\n                                                                                                                    //\n      var user = {                                                                                                  // 40\n        email: template.find('[name=\"emailAddress\"]').value,                                                        // 44\n        password: template.find('[name=\"password\"]').value                                                          // 45\n      }; // récupération de l'email de l'utilisateur demandant la création de compte                                //\n                                                                                                                    //\n      Accounts.createUser(user, function (error) {                                                                  // 40\n        if (error) {                                                                                                // 49\n          Bert.alert(error.reason, 'danger');                                                                       // 50\n        } else {                                                                                                    //\n          Meteor.call('sendVerificationLink', function (error, response) {                                          // 52\n            if (error) {                                                                                            // 53\n              Bert.alert(error.reason, 'danger');                                                                   // 54\n            } else {                                                                                                //\n              Bert.alert('Welcome!', 'success');                                                                    // 56\n            }                                                                                                       //\n          });                                                                                                       //\n        }                                                                                                           //\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return submitForm;                                                                                              //\n  }()                                                                                                               //\n}); // Génère des alertes grâce à Bert en fonction des données entrées par l'utilisateur (mauvais mdp, email. etc.)\n                                                                                                                    //\n_templating.Template.index.events({                                                                                 // 66\n  'click .resend-verification-link': function () {                                                                  // 67\n    function clickResendVerificationLink(event, template) {                                                         //\n      Meteor.call('sendVerificationLink', function (error, response) {                                              // 68\n        if (error) {                                                                                                // 69\n          Bert.alert(error.reason, 'danger');                                                                       // 70\n        } else {                                                                                                    //\n          var email = Meteor.user().emails[0].address;                                                              // 72\n          Bert.alert('Verification sent to ' + email + '!', 'success');                                             // 73\n        }                                                                                                           //\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return clickResendVerificationLink;                                                                             //\n  }()                                                                                                               //\n}); // lien pour renvoyé un mail de vérification au format alerte Bert                                              //\n                                                                                                                    //\nFlowRouter.route('/verify-email/:token', {                                                                          // 79\n  name: 'verify-email',                                                                                             // 80\n  action: function () {                                                                                             // 81\n    function action(params) {                                                                                       //\n      Accounts.verifyEmail(params.token, function (error) {                                                         // 82\n        if (error) {                                                                                                // 83\n          Bert.alert(error.reason, 'danger');                                                                       // 84\n        } else {                                                                                                    //\n          FlowRouter.go('/');                                                                                       // 86\n          Bert.alert('Email verified! Thanks!', 'success');                                                         // 87\n        }                                                                                                           //\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return action;                                                                                                  //\n  }()                                                                                                               //\n}); // Création du routing de vérification grâce à Flowrouter.                                                      //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]}},{\"extensions\":[\".js\",\".json\",\".html\",\".css\"]});\nrequire(\"./client/template.main.js\");\nrequire(\"./client/main.js\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["client/main.html","/client/template.main.js","/client/main.js"],"names":[],"mappings":";;;;;;;;AAAA;AACA,wH;;;;;;;;;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yH;;;;;;;;;;;ACjGA;;AACA;;AACA;;AACA;;AAEA,cAAc,IAAI,aAAM,UAAN,CAAiB,SAArB,CAAd;;AAEA,YAAY,YAAZ,CAAyB,IAAI,YAAJ,CAAiB;AACxC,SAAO;AACL,UAAM,MAAN;AACA,WAAO,OAAP;AACA,SAAK,GAAL;GAHF;AAKA,UAAQ;AACN,UAAM,MAAN;AACA,WAAO,QAAP;GAFF;AAIA,UAAQ;AACN,UAAM,MAAN;AACA,WAAO,kBAAP;AACA,SAAK,CAAL;GAHF;AAKA,QAAM;AACJ,UAAM,MAAN;AACA,WAAO,eAAP;GAFF;AAIA,YAAU;AACR,UAAM,MAAN;AACA,WAAO,UAAP;AACA,cAAU,IAAV;AACA,SAAK,IAAL;GAJF;CAnBuB,CAAzB;;;;AA+BA,qBAAS,MAAT,CAAgB,MAAhB,CAAuB;AACrB;wBAAgB,OAAO,UAAW;AAChC,YAAM,cAAN;;AADgC,UAG5B,OAAO;AACT,eAAO,SAAS,IAAT,CAAe,uBAAf,EAAyC,KAAzC;AACP,kBAAU,SAAS,IAAT,CAAe,mBAAf,EAAqC,KAArC;OAFR;;AAH4B,cAQhC,CAAS,UAAT,CAAqB,IAArB,EAA2B,UAAE,KAAF,EAAa;AACtC,YAAK,KAAL,EAAa;AACX,eAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;SAAb,MAEO;AACL,iBAAO,IAAP,CAAa,sBAAb,EAAqC,UAAE,KAAF,EAAS,QAAT,EAAuB;AAC1D,gBAAK,KAAL,EAAa;AACX,mBAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;aAAb,MAEO;AACL,mBAAK,KAAL,CAAY,UAAZ,EAAwB,SAAxB,EADK;aAFP;WADmC,CAArC,CADK;SAFP;OADyB,CAA3B,CARgC;;;;KADb;CAAvB;;AA2BA,qBAAS,KAAT,CAAe,MAAf,CAAsB;AACpB;yCAAoC,OAAO,UAAW;AACpD,aAAO,IAAP,CAAa,sBAAb,EAAqC,UAAE,KAAF,EAAS,QAAT,EAAuB;AAC1D,YAAK,KAAL,EAAa;AACX,eAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;SAAb,MAEO;AACL,cAAI,QAAQ,OAAO,IAAP,GAAc,MAAd,CAAsB,CAAtB,EAA0B,OAA1B,CADP;AAEL,eAAK,KAAL,2BAAqC,WAArC,EAAgD,SAAhD,EAFK;SAFP;OADmC,CAArC,CADoD;;;;KADlC;CAAtB;;AAaA,WAAW,KAAX,CAAkB,sBAAlB,EAA0C;AACxC,QAAM,cAAN;AACA;oBAAQ,QAAS;AACf,eAAS,WAAT,CAAsB,OAAO,KAAP,EAAc,UAAE,KAAF,EAAY;AAC9C,YAAK,KAAL,EAAa;AACX,eAAK,KAAL,CAAY,MAAM,MAAN,EAAc,QAA1B,EADW;SAAb,MAEO;AACL,qBAAW,EAAX,CAAe,GAAf,EADK;AAEL,eAAK,KAAL,CAAY,yBAAZ,EAAuC,SAAvC,EAFK;SAFP;OADkC,CAApC,CADe;;;;KAFuB;CAA1C,qH","file":"/app.js","sourcesContent":["module.exports = require(\"./template.main.js\");\n","\nTemplate.body.addContent((function() {\n  var view = this;\n  return [ Spacebars.include(view.lookupTemplate(\"accueil\")), HTML.Raw(\"\\n  <p>----------------------------------</p>\\n  \"), Blaze.View(\"lookup:signup\", function() {\n    return Spacebars.mustache(view.lookup(\"signup\"));\n  }), \" \\n  \\n  \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"currentUser\"));\n  }, function() {\n    return [ \" \\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"recherche\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"affichage_annonce\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", HTML.H2(\"Insert:\"), \"\\n  \", HTML.Comment(\"{{> creer_annonce}}\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"insertAnnonceForm\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", HTML.H2(\"Update:\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"updateAnnonceForm\")), \"\\n  \", HTML.P(\"----------------------------------\"), \"\\n  \", Spacebars.include(view.lookupTemplate(\"grouper_annonce\")), \"\\n\\n\" ];\n  }, function() {\n    return [ \"\\n    \", HTML.P(\"You must be logged-in to see this content.\"), \"\\n\\n  \" ];\n  }) ];\n}));\nMeteor.startup(Template.body.renderToDocument);\n\nTemplate.__checkName(\"accueil\");\nTemplate[\"accueil\"] = new Template(\"Template.accueil\", (function() {\n  var view = this;\n  return HTML.Raw(\"<h1>Bienvenue sur l'app LAMA</h1>\");\n}));\n\nTemplate.__checkName(\"register\");\nTemplate[\"register\"] = new Template(\"Template.register\", (function() {\n  var view = this;\n  return HTML.Raw('<h2>Register</h2>\\n    <form class=\"register\">\\n        <p>Email: <input type=\"email\" name=\"email\"></p>\\n        <p>Password: <input type=\"password\" name=\"password\"></p>\\n        <p><input type=\"submit\" value=\"Register\"></p>\\n    </form>');\n}));\n\nTemplate.__checkName(\"recherche\");\nTemplate[\"recherche\"] = new Template(\"Template.recherche\", (function() {\n  var view = this;\n  return HTML.Raw('<p>Rechercher un livre:</p>\\n  <form>\\n    Entrer l\\'ISBN, le titre du livre ou l\\'auteur: <input type=\"text\">\\n    <input type=\"button\" value=\"Rechercher\">\\n  </form>');\n}));\n\nTemplate.__checkName(\"affichage_annonce\");\nTemplate[\"affichage_annonce\"] = new Template(\"Template.affichage_annonce\", (function() {\n  var view = this;\n  return HTML.Raw(\"<p>Annonces disponibles:</p>\\n  <ul>\\n    <li>\\n      Annonce 1\\n      <div>Prix</div> <br>\\n    </li>\\n    <li>\\n      Annonce 2\\n      <div>Prix</div> <br>\\n    </li>\\n    <li>\\n      Annonce 3\\n      <div>Prix</div> <br>\\n    </li>\\n  </ul>\");\n}));\n\nTemplate.__checkName(\"insertAnnonceForm\");\nTemplate[\"insertAnnonceForm\"] = new Template(\"Template.insertAnnonceForm\", (function() {\n  var view = this;\n  return Blaze._TemplateWith(function() {\n    return {\n      collection: Spacebars.call(\"AnnonceList\"),\n      id: Spacebars.call(\"insertAnnonceForm\"),\n      type: Spacebars.call(\"insert\")\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"quickForm\"));\n  });\n}));\n\nTemplate.__checkName(\"updateAnnonceForm\");\nTemplate[\"updateAnnonceForm\"] = new Template(\"Template.updateAnnonceForm\", (function() {\n  var view = this;\n  return Blaze._TemplateWith(function() {\n    return {\n      collection: Spacebars.call(\"AnnonceList\"),\n      id: Spacebars.call(\"updateAnnonceForm\"),\n      type: Spacebars.call(\"update\")\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"quickForm\"));\n  });\n}));\n\nTemplate.__checkName(\"grouper_annonce\");\nTemplate[\"grouper_annonce\"] = new Template(\"Template.grouper_annonce\", (function() {\n  var view = this;\n  return HTML.Raw('Grouper mes annonces: <br>\\n  <ul>\\n    <li>\\n      Annonce 1\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 2\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 3\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 4\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n    <li>\\n      Annonce 5\\n      <input type=\"checkbox\">\\n    </li>\\n    <br>\\n  </ul>\\n  <form>\\n    <input type=\"text\" placeholder=\"prix de groupe\">\\n    <input type=\"button\" value=\"Grouper\">\\n  </form>');\n}));\n\nTemplate.__checkName(\"signup\");\nTemplate[\"signup\"] = new Template(\"Template.signup\", (function() {\n  var view = this;\n  return HTML.Raw('<div class=\"row\">\\n    <div class=\"col-xs-12 col-sm-6 col-md-4\">\\n      <h4 class=\"page-header\">Sign Up</h4>\\n      <form id=\"signup\" class=\"signup\">\\n        <div class=\"form-group\">\\n          <label for=\"emailAddress\">Email Address</label>\\n          <input type=\"email\" name=\"emailAddress\" class=\"form-control\" placeholder=\"Email Address\">\\n        </div>\\n        <div class=\"form-group\">\\n          <label for=\"password\">Password</label>\\n          <input type=\"password\" name=\"password\" class=\"form-control\" placeholder=\"Password\">\\n        </div>\\n        <div class=\"form-group\">\\n          <input type=\"submit\" class=\"btn btn-success\" value=\"Sign Up\">\\n        </div>\\n      </form>\\n    </div>\\n  </div>');\n}));\n\nTemplate.__checkName(\"index\");\nTemplate[\"index\"] = new Template(\"Template.index\", (function() {\n  var view = this;\n  return Blaze.Unless(function() {\n    return Spacebars.call(Spacebars.dot(view.lookup(\"currentUser\"), \"emails\", \"0\", \"verified\"));\n  }, function() {\n    return [ \"\\n    \", HTML.P({\n      \"class\": \"alert alert-warning\"\n    }, \"You need to verify your email address before using Unibooks. \", HTML.A({\n      href: \"#\",\n      \"class\": \"resend-verification-link\"\n    }, \"Resend verification link\"), \".\"), \"\\n  \" ];\n  }, function() {\n    return [ \"\\n    \", HTML.H3(\"From all the way Downtown!\"), \"\\n    \", HTML.IMG({\n      src: \"https://media.giphy.com/media/dpu95OTQ9rDPi/giphy.gif\"\n    }), \"\\n  \" ];\n  });\n}));\n","import { Template } from 'meteor/templating';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { Mongo } from 'meteor/mongo';\nimport './main.html';\n\nAnnonceList = new Mongo.Collection('annonce');\n\nAnnonceList.attachSchema(new SimpleSchema({\n  title: {\n    type: String,\n    label: \"Title\",\n    max: 200\n  },\n  author: {\n    type: String,\n    label: \"Author\"\n  },\n  copies: {\n    type: Number,\n    label: \"Number of copies\",\n    min: 0\n  },\n  etat: {\n    type: String,\n    label: \"Etat du livre\"\n  },\n  remarque: {\n    type: String,\n    label: \"Remarque\",\n    optional: true,\n    max: 1000\n  }\n}));\n\t\n\n\n//Le code qui correspond au if(meteorisclient) de l'ancien fichier 1.2\n  \nTemplate.signup.events({\n  'submit form' ( event, template ) {\n    event.preventDefault(); // création d'une event lorsque l'utilisateur soumet sa demande de création de compte\n    \n    let user = {\n      email: template.find( '[name=\"emailAddress\"]' ).value,\n      password: template.find( '[name=\"password\"]' ).value\n    }; // récupération de l'email de l'utilisateur demandant la création de compte\n\n    Accounts.createUser( user, ( error ) => {\n      if ( error ) {\n        Bert.alert( error.reason, 'danger' );\n      } else {\n        Meteor.call( 'sendVerificationLink', ( error, response ) => {\n          if ( error ) {\n            Bert.alert( error.reason, 'danger' );\n          } else {\n            Bert.alert( 'Welcome!', 'success' );\n          }\n        });\n      }\n    });\n  }\n}); // Génère des alertes grâce à Bert en fonction des données entrées par l'utilisateur (mauvais mdp, email. etc.)\n\n\n\nTemplate.index.events({\n  'click .resend-verification-link' ( event, template ) {\n    Meteor.call( 'sendVerificationLink', ( error, response ) => {\n      if ( error ) {\n        Bert.alert( error.reason, 'danger' );\n      } else {\n        let email = Meteor.user().emails[ 0 ].address;\n        Bert.alert( `Verification sent to ${ email }!`, 'success' );\n      }\n    });\n  }\n}); // lien pour renvoyé un mail de vérification au format alerte Bert\n\nFlowRouter.route( '/verify-email/:token', {\n  name: 'verify-email',\n  action( params ) {\n    Accounts.verifyEmail( params.token, ( error ) =>{\n      if ( error ) {\n        Bert.alert( error.reason, 'danger' );\n      } else {\n        FlowRouter.go( '/' );\n        Bert.alert( 'Email verified! Thanks!', 'success' );\n      }\n    });\n  }\n}); // Création du routing de vérification grâce à Flowrouter. \n"]}}]